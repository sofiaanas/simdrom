{"name":"SIMdrom","tagline":"Simulate Exomes or Genomes and spike in mutations","body":"# SIMdrom\r\n\r\nSimulate Exomes, Genomes, or self defined populations and spike in mutations. SIMdrom is a Java program to randomly select variants in a VCF file and create a new VCF file. A second VCF file can be used to spike in other randomly selected variants. Homozygous and heterozygous genotypes are selected by the Hardy-Weinberg principle. SIMdrom also exposes its functionality through a library API.\r\n\r\n## Use cases\r\n\r\nThere are two typical use-cases where you can use SIMdrom. \r\n\r\n1. Generate a random variant files to test you NGS pipeline.\r\n2. Generate a random variant files and spike in a pathogenic mutations. You can use the files for performance validation of your diagnostic, gene prioritisation, or variant prioritisation pipeline.   \r\n \r\n\r\n## Quickstart\r\n\r\n### Use 1000 Genomes to generate a random genome\r\n\r\nDownload the *.sites.vcf.gz from 1000Genomes - ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/ - and the corresponding index file *.sites.vcf.gz.tbi. The VCF-file should contain a `AF` identifier in the info column.\r\n\r\nRun SIMdrom with the downloaded VCF file\r\n```\r\n# java -jar jannovar-cli-0.0.1.jar -b ALL.wgs.phase3_shapeit2_mvncall_integrated_v5a.20130502.sites.vcf.gz -bAF AF\r\n```\r\nThe new sampled individual will be printed out into the standard output. You can pipe it into a VCF file.\r\n ```\r\n# java -jar jannovar-cli-0.0.1.jar -b ALL.wgs.phase3_shapeit2_mvncall_integrated_v5a.20130502.sites.vcf.gz -bAF AF > newIndividualVCFfile.vcf\r\n```\r\nor generate a bgziped file\r\n```\r\n# java -jar jannovar-cli-0.0.1.jar -b ALL.wgs.phase3_shapeit2_mvncall_integrated_v5a.20130502.sites.vcf.gz -bAF AF | bgzip -c | > newIndividualVCFfile.vcf.gz\r\n```\r\n\r\n### Use ExAC to generate a random Exome\r\n\r\nDownload the current ExAC release from the Broadinstitute FTP - ftp://ftp.broadinstitute.org/pub/ExAC_release/ - and the corresponding index file. The VCF-file should contain a `AF` identifier in the info column.\r\n\r\nRun SIMdrom with the downloaded VCF file\r\n```\r\n# java -jar jannovar-cli-0.0.1.jar -b ExAC.r0.3.sites.vep.vcf.gz -bAF AF\r\n```\r\n\r\n### Use 1000 Genomes to generate a random genome of an ethnical population\r\n\r\nDownload the 1000Genomes sites VCF file as described earlier. Ít contains allele frequencies from 5 different populations:\r\n\r\n|Identifier | Population|\r\n|-----------|-----------|\r\n|EAS_AF     |EAS        |\r\n|EUR_AF     |EUR        |\r\n|AFR_AF     |AFR        |\r\n|AMR_AF     |AMR        |\r\n|SAS_AF     |SAS        |\r\n\r\nFor example if you want to sample an european individual use the following command:\r\n```\r\n# java -jar jannovar-cli-0.0.1.jar -b ALL.wgs.phase3_shapeit2_mvncall_integrated_v5a.20130502.sites.vcf.gz -bAF EUR_AF\r\n```\r\n\r\n### Use ExAC to generate a random Exome of an ethnical population\r\n\r\nDownload the ExAC VCF file as described earlier. Ít contains allele frequencies from 7 different populations. But instead of allele frequencies the counts of alternative and total alleles are provided. So we have to use two options in SIMdrom `-bAC` (alt allele counts) and `-bAN`(total allele counts)\r\n\r\n\r\n\r\n|Identifier ALT allele counts | Identifier total allele counts | Population           |\r\n|-----------------------------|--------------------------------|----------------------|\r\n|AC_AFR                       |AN_AFR                       |African/African American |\r\n|AC_AMR                       |AN_AFR                       |American                 |\r\n|AC_EAS                       |AN_AFR                       |East Asian               |\r\n|AC_FIN                       |AN_AFR                       |Finnish                  |\r\n|AC_NFE                       |AN_AFR                       |Non-Finnish European     |\r\n|AC_OTH                       |AN_AFR                       |Other Allele             |\r\n|AC_SAS                       |AN_AFR                       |South Asian Allele       |\r\n\r\nFor example if you want to sample an american individual use the following command:\r\n```\r\n# java -jar jannovar-cli-0.0.1.jar -b ExAC.r0.3.sites.vep.vcf.gz -bAC AC_AMR -bAN AN_AMR\r\n```\r\n\r\n### Randomly select one genome of 1000Genomes\r\n\r\nYou can also just select one genotype of an individual of a 1000genomes sample. Therefore you have to download the genotype VCF files from 1000Genomes - ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/ - and the corresponding index files. Right now, SIMdrom can only use one input VCF as background population. Therefore you have to merge the files that are divided by chromosome. Now you can use the `--single-sample` option to select only one genotype.\r\n\r\n ```\r\n# java -jar ALL.ALLChr.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz -bAC AC_AMR -bAN AN_AMR\r\n```\r\n\r\n\r\n### Spike in a pathogenic mutation of ClinVar\r\n\r\nDownload the ClinVar VCF ind index file from the NCBI FTP - ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/. Not every included variant is known as pathogenic. To use only the known pathogenic variants we have to use the info column filter of SIMdrom on the mutations file: `--mutations-info-filter`. The pathogenicity is decoded in the `CLNSIG` identifier with the number `5`. The corresponding SIMdrom option is `--mutations-info-filter CLNSIG=5`.\r\n\r\nIf we only want to spike in 1 mutation we have to use the `--mutations-variants-amount` with the value `1`. We can increase the value if we want more spiked in mutations. Every mutation has an equal probability to be chosen.\r\n\r\nTo find out the spiked in mutation(s), we can deliver a spike in log-file with the option `--spike-in-log`. The spike in log format is TSV and includes every spiked in mutation (TSV for better readability). \r\n\r\nIn this example we use ExAC as background population and spike in one ClinVar mutation:\r\n```\r\n# java -jar jannovar-cli-0.0.1.jar -b ExAC.r0.3.sites.vep.vcf.gz -bAF AF -m clinvar.vcf.gz --mutations-info-filter CLINSIG=5 --mutations-variants-amount 1 --spike-in-log clinVarSpikeInLog.tsv\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}